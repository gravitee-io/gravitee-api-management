kind: Analytics
group: analytics.gravitee.io
version: v2alpha1
spec:
  apis:
    - name: HTTP_PROXY
      label: HTTP Proxy
    - name: LLM
      label: LLM
    - name: MESSAGE
      label: Message
    - name: KAFKA
      label: Kafka
    - name: MCP
      label: MCP

  metrics:
    intervals:
      - auto
    values:
      - name: HTTP_REQUEST_COUNT
        label: Request count
        apis:
          - HTTP_PROXY
          - LLM
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document

      - name: HTTP_ERROR_RATE
        label: Error Rate
        apis:
          - HTTP_PROXY
          - LLM
        type: gauge
        unit: percent
        aggregations: []
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document

      - name: HTTP_REQUEST_CONTENT_LENGTH
        label: Request content length
        apis:
          - HTTP_PROXY
          - LLM
        type: gauge
        unit: bytes
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        backend:
          elasticsearch:
            indices:
              - v4-metrics
              - requests
            type: document
            field: request-content-length

      - name: HTTP_RESPONSE_CONTENT_LENGTH
        label: Response content length
        apis:
          - HTTP_PROXY
          - LLM
        type: gauge
        unit: bytes
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        backend:
          elasticsearch:
            indices:
              - v4-metrics
          type: document
          field: request-content-length

      - name: HTTP_ENDPOINT_RESPONSE_TIME
        label: Endpoint response time
        apis:
          - HTTP_PROXY
          - LLM
        type: gauge
        unit: ms
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION

          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document
            field: endpoint-response-time-ms

      - name: HTTP_GATEWAY_RESPONSE_TIME
        label: Gateway response time
        apis:
          - HTTP_PROXY
          - LLM
        type: gauge
        unit: ms
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document
            field: gateway-response-time-ms

      - name: HTTP_GATEWAY_LATENCY
        label: Latency
        apis:
          - HTTP_PROXY
          - LLM
        type: gauge
        unit: ms
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document
            field: gateway-latency-ms

      - name: LLM_PROMPT_TOKEN_SENT
        label: Sent token count
        apis:
          - LLM
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - LLM_PROMPT_TOKEN_SENT
            - LLM_PROMPT_TOKEN_RECEIVE
            - LLM_PROMPT_TOKEN_SENT_COST
            - LLM_PROMPT_TOKEN_RECEIVE_COST
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document
            countWith:
              field: additional-metrics.long_ai-prompt-token-sent
              method: sum

      - name: LLM_PROMPT_TOKEN_RECEIVE
        label: Received token count
        apis:
          - LLM
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - LLM_PROMPT_TOKEN_SENT
            - LLM_PROMPT_TOKEN_RECEIVE
            - LLM_PROMPT_TOKEN_SENT_COST
            - LLM_PROMPT_TOKEN_RECEIVE_COST
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document
            countWith:
              field: additional-metrics.long_ai-prompt-token-receive
              method: sum

      - name: LLM_PROMPT_TOKEN_SENT_COST
        label: Sent token cost
        apis:
          - LLM
        type: gauge
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - LLM_PROMPT_TOKEN_SENT
            - LLM_PROMPT_TOKEN_RECEIVE
            - LLM_PROMPT_TOKEN_SENT_COST
            - LLM_PROMPT_TOKEN_RECEIVE_COST
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document
            field: additional-metrics.double_ai-prompt-token-sent-cost

      - name: LLM_PROMPT_TOKEN_RECEIVE_COST
        label: Received token cost
        apis:
          - LLM
        type: gauge
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HTTP_GATEWAY_LATENCY
          - HTTP_GATEWAY_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - LLM_PROMPT_TOKEN_SENT
            - LLM_PROMPT_TOKEN_RECEIVE
            - LLM_PROMPT_TOKEN_SENT_COST
            - LLM_PROMPT_TOKEN_RECEIVE_COST
        backend:
          elasticsearch:
            indices:
              - v4-metrics
            type: document
            field: additional-metrics.double_ai-prompt-token-receive-cost

      - name: MESSAGE_PAYLOAD_SIZE
        label: Message Payload Size
        apis:
          - MESSAGE
        type: gauge
        unit: ms
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
          - MESSAGE_CONNECTOR_ID
          - MESSAGE_CONNECTOR_TYPE
          - MESSAGE_OPERATION_TYPE
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - MESSAGE_CONNECTOR_ID
            - MESSAGE_CONNECTOR_TYPE
            - MESSAGE_OPERATION_TYPE
            - MESSAGE_ERROR_COUNT
            - MESSAGE_COUNT
            - MESSAGE_GATEWAY_LATENCY
        backend:
          elasticsearch:
            indices:
              - v4-message-metrics
            type: document
            field: content-length
        joinFacets:
          facets:
            - API
            - APPLICATION
            - PLAN
            - GATEWAY
            - TENANT
            - ZONE
            - HTTP_METHOD
            - HTTP_STATUS_CODE_GROUP
            - HTTP_STATUS
            - HTTP_PATH
            - HTTP_PATH_MAPPING
            - HTTP_USER_AGENT_OS_NAME
            - HTTP_USER_AGENT_DEVICE
            - HOST
            - GEO_IP_COUNTRY
            - GEO_IP_REGION
            - GEO_IP_CITY
            - GEO_IP_CONTINENT
            - CONSUMER_IP
          followIndex: v4-metrics
          correlationField: request-id

      - name: MESSAGE_COUNT
        label: Message count
        apis:
          - MESSAGE
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - MESSAGE_CONNECTOR_ID
            - MESSAGE_CONNECTOR_TYPE
            - MESSAGE_OPERATION_TYPE
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HTTP_ENDPOINT_RESPONSE_TIME
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - MESSAGE_CONNECTOR_ID
            - MESSAGE_CONNECTOR_TYPE
            - MESSAGE_OPERATION_TYPE
            - MESSAGE_ERROR_COUNT
            - MESSAGE_COUNT
            - MESSAGE_GATEWAY_LATENCY
        backend:
          elasticsearch:
            indices:
              - v4-message-metrics
            type: document
            countWith:
              field: count-increment
              method: sum
            joinFacets:
              facets:
                - API
                - APPLICATION
                - PLAN
                - GATEWAY
                - TENANT
                - ZONE
                - HTTP_METHOD
                - HTTP_STATUS_CODE_GROUP
                - HTTP_STATUS
                - HTTP_PATH
                - HTTP_PATH_MAPPING
                - HTTP_USER_AGENT_OS_NAME
                - HTTP_USER_AGENT_DEVICE
                - HOST
                - GEO_IP_COUNTRY
                - GEO_IP_REGION
                - GEO_IP_CITY
                - GEO_IP_CONTINENT
                - CONSUMER_IP
              followIndex: v4-metrics
              correlationField: request-id

      - name: MESSAGE_ERROR_COUNT
        label: Message Error Count
        apis:
          - MESSAGE
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - MESSAGE_CONNECTOR_ID
            - MESSAGE_CONNECTOR_TYPE
            - MESSAGE_OPERATION_TYPE
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - MESSAGE_CONNECTOR_ID
            - MESSAGE_CONNECTOR_TYPE
            - MESSAGE_OPERATION_TYPE
            - MESSAGE_ERROR_COUNT
            - MESSAGE_COUNT
            - MESSAGE_GATEWAY_LATENCY
        backend:
          elasticsearch:
            indices:
              - v4-message-metrics
            type: document
            countWith:
              field: error-count-increment
              method: sum
          joinFacets:
            facets:
              - API
              - APPLICATION
              - PLAN
              - GATEWAY
              - TENANT
              - ZONE
              - HTTP_METHOD
              - HTTP_STATUS_CODE_GROUP
              - HTTP_STATUS
              - HTTP_PATH
              - HTTP_PATH_MAPPING
              - HTTP_USER_AGENT_OS_NAME
              - HTTP_USER_AGENT_DEVICE
              - HOST
              - GEO_IP_COUNTRY
              - GEO_IP_REGION
              - GEO_IP_CITY
              - GEO_IP_CONTINENT
              - CONSUMER_IP
            followIndex: v4-metrics
            correlationField: request-id

      - name: MESSAGE_GATEWAY_LATENCY
        label: Message processing time
        apis:
          - MESSAGE
        type: gauge
        unit: ms
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_METHOD
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - MESSAGE_CONNECTOR_ID
            - MESSAGE_CONNECTOR_TYPE
            - MESSAGE_OPERATION_TYPE
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - TENANT
          - ZONE
          - HTTP_STATUS_CODE_GROUP
          - HTTP_STATUS
          - HTTP_PATH
          - HTTP_PATH_MAPPING
          - HTTP_USER_AGENT_OS_NAME
          - HTTP_USER_AGENT_DEVICE
          - HOST
          - GEO_IP_COUNTRY
          - GEO_IP_REGION
          - GEO_IP_CITY
          - GEO_IP_CONTINENT
          - CONSUMER_IP
            - MESSAGE_CONNECTOR_ID
            - MESSAGE_CONNECTOR_TYPE
            - MESSAGE_OPERATION_TYPE
            - MESSAGE_ERROR_COUNT
            - MESSAGE_COUNT
            - MESSAGE_GATEWAY_LATENCY
        backend:
          elasticsearch:
            indices:
              - v4-message-metrics
            type: document
            field: gateway-latency-ms
            joinFacets:
              facets:
                - API
                - APPLICATION
                - PLAN
                - GATEWAY
                - TENANT
                - ZONE
                - HTTP_METHOD
                - HTTP_STATUS_CODE_GROUP
                - HTTP_STATUS
                - HTTP_PATH
                - HTTP_PATH_MAPPING
                - HTTP_USER_AGENT_OS_NAME
                - HTTP_USER_AGENT_DEVICE
                - HOST
                - GEO_IP_COUNTRY
                - GEO_IP_REGION
                - GEO_IP_CITY
                - GEO_IP_CONTINENT
                - CONSUMER_IP
              followIndex: v4-metrics
              correlationField: request-id

      - name: KAFKA_DOWNSTREAM_PUBLISH_MESSAGES
        label: Downstream Publish Messages
        apis:
          - KAFKA
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: downstream-publish-messages-total

      - name: KAFKA_DOWNSTREAM_SUBSCRIBE_MESSAGES
        label: Downstream Subscribe Messages
        apis:
          - KAFKA
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        backend:
          elasticsearch:
            indices:
              - event-metrics

      - name: KAFKA_DOWNSTREAM_PUBLISH_MESSAGES_BYTES
        label: Downstream Publish Message Bytes
        apis:
          - KAFKA
        type: gauge
        unit: bytes
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: downstream-publish-messages-bytes

      - name: KAFKA_DOWNSTREAM_SUBSCRIBE_MESSAGE_BYTES
        label: Downstream Subscribe Message Bytes
        apis:
          - KAFKA
        type: gauge
        unit: bytes
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: downstream-subscribe-messages-bytes

      - name: KAFKA_UPSTREAM_PUBLISH_MESSAGES
        label: Upstream Publish Messages
        apis:
          - KAFKA
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - KAFKA_TOPIC
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: upstream-publish-messages-total

      - name: KAFKA_UPSTREAM_SUBSCRIBE_MESSAGES
        label: Upstream Subscribe Messages
        apis:
          - KAFKA
        type: counter
        aggregations:
          - COUNT
          - RPS
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: upstream-subscribe-messages-total

      - name: KAFKA_UPSTREAM_PUBLISH_MESSAGE_BYTES
        label: Upstream Publish Message Bytes
        apis:
          - KAFKA
        type: gauge
        unit: bytes
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: upstream-publish-message-bytes

      - name: KAFKA_UPSTREAM_SUBSCRIBE_MESSAGE_BYTES
        label: Upstream Subscribe Message Bytes
        apis:
          - KAFKA
        type: gauge
        unit: bytes
        aggregations:
          - AVG
          - MIN
          - MAX
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
          - KAFKA_TOPIC
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
            - KAFKA_TOPIC
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: upstream-subscribe-message-bytes

      - name: KAFKA_DOWNSTREAM_AUTHENTICATION_SUCCESSES
        label: Downstream Authentication Successes
        apis:
          - KAFKA
        type: counter
        aggregations:
          - COUNT
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: downstream-authentication-successes-total

      - name: KAFKA_DOWNSTREAM_AUTHENTICATED_CONNECTIONS
        label: Downstream Authenticated Connections
        apis:
          - KAFKA
        type: gauge
        aggregations:
          - MAX
          - AVG
          - MIN
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: downstream-authenticated-connections

      - name: KAFKA_UPSTREAM_AUTHENTICATION_SUCCESSES
        label: Upstream Authentication Successes
        apis:
          - KAFKA
        type: counter
        aggregations:
          - COUNT
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: upstream-authentication-successes-total

      - name: KAFKA_UPSTREAM_AUTHENTICATED_CONNECTIONS
        label: Upstream Authenticated Connections
        apis:
          - KAFKA
        type: gauge
        aggregations:
          - MAX
          - MIN
          - AVG
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: upstream-authenticated-connections

      - name: KAFKA_UPSTREAM_AUTHENTICATION_ERRORS
        label: Upstream Authentication Errors
        apis:
          - KAFKA
        type: counter
        aggregations:
          - COUNT
        by:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        filter:
          - API
          - APPLICATION
          - PLAN
          - GATEWAY
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: upstream-authentication-failures-total

      - name: KAFKA_DOWNSTREAM_AUTHENTICATION_ERRORS
        label: Downstream Authentication Errors
        apis:
          - KAFKA
        type: counter
        aggregations:
          - COUNT
        by:
          - API
          - GATEWAY
        filter:
          - API
          - GATEWAY
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: downstream-authentication-failures-total

      - name: KAFKA_DOWNSTREAM_ACTIVE_CONNECTIONS
        label: Downstream Active Connections
        apis:
          - KAFKA
        type: gauge
        aggregations:
          - MIN
          - MAX
          - AVG
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - GATEWAY
        filter:
          - API
          - GATEWAY
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: downstream-active-connections

      - name: KAFKA_UPSTREAM_ACTIVE_CONNECTIONS
        label: Upstream Active Connections
        apis:
          - KAFKA
        type: gauge
        aggregations:
          - MIN
          - MAX
          - AVG
          - P50
          - P90
          - P95
          - P99
        by:
          - API
          - GATEWAY
        filter:
          - API
          - GATEWAY
        backend:
          elasticsearch:
            indices:
              - event-metrics
            type: data-stream
            field: upstream-active-connections

      - name: SUBSCRIPTIONS_COUNT
        label: Subscriptions Count
        apis:
          - HTTP_PROXY
          - MESSAGE
          - KAFKA
          - LLM
          - MCP
        type: counter
        aggregations:
          - COUNT
        by:
          - API
          - APPLICATION
        filter:
          - API
          - APPLICATION
        backend:
          mongodb:
            collection: subscriptions
            timestampField: createdAt
            groupWith:
              - facet: API
                field: api
              - facet: APPLICATION
                field: application
            filterWith:
              - facet: API
                field: api
              - facet: APPLICATION
                field: application
            additionalFilters:
              - and:
                  - or:
                      - status: ACCEPTED
                      - status: RESUMED
                  - consummerStatus: STARTED

      - name: API_COUNT
        label: APIs Count
        apis:
          - HTTP_PROXY
          - MESSAGE
          - KAFKA
          - LLM
          - MCP
        type: counter
        aggregations:
          - COUNT
        by:
          - API_STATE
          - API_LIFECYCLE_STATE
          - API_VISIBILITY
        filter:
          - API_STATE
          - API_LIFECYCLE_STATE
          - API_VISIBILITY
        backend:
          mongodb:
            collection: apis
            frameTimeWith:
              lower: createdAt
              upper: createdAt
            groupWith:
              - facet: API_LIFECYCLE_STATE
                field: apiLifecycleState
              - facet: API_VISIBILITY
                field: visibility
            filterWith:
              - facet: API_LIFECYCLE_STATE
                field: apiLifecycleState
              - facet: API_VISIBILITY
                field: visibility
            additionalFilters: []

  filters:
    - name: API
      label: API
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: api-id

    - name: APPLICATION
      label: Application
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: application-id

    - name: PLAN
      label: Plan
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: plan-id

    - name: GATEWAY
      label: Gateway
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: gateway

    - name: TENANT
      label: Tenant
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: tenant

    - name: ZONE
      label: Zone
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: zone

    - name: HTTP_METHOD
      label: HTTP Method
      type: enum
      enum:
        - CONNECT
        - DELETE
        - GET
        - HEAD
        - OPTIONS
        - PATCH
        - POST
        - PUT
        - TRACE
        - OTHER
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: http-method
          valueMapping:
            CONNECT:
              value: 1
            DELETE:
              value: 2
            GET:
              value: 3
            HEAD:
              value: 4
            OPTIONS:
              value: 5
            PATCH:
              value: 6
            POST:
              value: 7
            PUT:
              value: 8
            TRACE:
              value: 9
            OTHER:
              value: 0

    - name: HTTP_STATUS_CODE_GROUP
      label: Status Code Group
      type: enum
      enum:
        - 1xx
        - 2xx
        - 3xx
        - 4xx
        - 5xx
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: status
          valueMapping:
            1xx:
              range:
                gte: 100
                lte: 199
            2xx:
              range:
                gte: 200
                lte: 299
            3xx:
              range:
                gte: 300
                lte: 399
            4xx:
              range:
                gte: 400
                lte: 499

    - name: HTTP_STATUS
      label: Status Code
      type: integer
      range:
        min: 100
        max: 600
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: status

    - name: HTTP_PATH
      label: HTTP Path
      type: string
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: path-info

    - name: HTTP_PATH_MAPPING
      label: Path Mapping
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: mapped-path

    - name: HOST
      label: Host
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: host

    - name: GEO_IP_COUNTRY
      label: Country
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: geoip.country_iso_code

    - name: GEO_IP_REGION
      label: Region
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: geoip.region_name

    - name: GEO_IP_CITY
      label: City
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: geoip.city_name

    - name: GEO_IP_CONTINENT
      label: Continent
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: geoip.continent_name

    - name: CONSUMER_IP
      label: Consumer IP
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: remote-address

    - name: HTTP_USER_AGENT_OS_NAME
      label: User Agent OS
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: user_agent.os.name

    - name: HTTP_USER_AGENT_DEVICE
      label: User Agent Device
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: user_agent.device.name

    - name: MESSAGE_CONNECTOR_TYPE
      label: Connector Type
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: connector-type

    - name: MESSAGE_OPERATION_TYPE
      label: Operation
      type: enum
      enum:
        - Publish
        - Subscribe
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: operation
          valueMapping:
            Publish:
              value: publish
            Subscribe:
              value: subscribe

    - name: KAFKA_TOPIC
      label: Topic
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: topic

    - name: API_STATE
      label: API State
      type: enul
      enum:
        - STARTED
        - STOPPED
      operators:
        - EQ
        - IN
      backend:
        mongodb:
          collection: apis
          field: lifecycleState

    - name: API_LIFECYCLE_STATE
      label: API Lifecycle State
      type: enum
      enum:
        - PUBLISHED
        - UNPUBLISHED
        - DEPRECATED
      operators:
        - EQ
        - IN
      backend:
        mongodb:
          collection: apis
          field: apiLifecycleState
        valueMapping:
          PUBLISHED:
            value: PUBLISHED
          UNPUBLISHED:
            values:
              - UNPUBLISHED
              - CREATED
          DEPRECATED:
            value: DEPRECATED

    - name: API_VISIBILITY
      label: API Visibility
      type: enum
      enum:
        - PUBLIC
        - PRIVATE
      operators:
        - EQ
        - IN
      backend:
        mongodb:
          collection: apis
          field: visibility
        valueMapping:
          PUBLISHED:
            value: PUBLISHED
          PRIVATE:
            value: PRIVATE

    - name: MESSAGE_SIZE
      label: Message Size
      type: long
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: content-length

    - name: MESSAGE_COUNT
      label: Message Count
      type: long
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: count

    - name: MESSAGE_ERROR_COUNT
      label: Errors
      type: long
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: error-count

    - name: HTTP_ENDPOINT_RESPONSE_TIME
      label: Endpoint Response Time
      type: long
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: endpoint-response-time-ms

    - name: HTTP_GATEWAY_LATENCY
      label: Latency
      type: long
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: gateway-latency-ms

    - name: HTTP_GATEWAY_RESPONSE_TIME
      label: Gateway Response Time
      type: long
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: gateway-response-time-ms

    - name: HTTP_REQUEST_CONTENT_LENGTH
      label: Request Size
      type: long
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: request-content-length

    - name: HTTP_RESPONSE_CONTENT_LENGTH
      label: Response Size
      type: long
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: response-content-length

  facets:
    - name: API
      label: API
      type: keyword
      backend:
        elasticsearch:
          field: api-id

    - name: APPLICATION
      label: Application
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: application-id

    - name: PLAN
      label: Plan
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: plan-id

    - name: GATEWAY
      label: Gateway
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: gateway

    - name: TENANT
      label: Tenant
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: tenant

    - name: ZONE
      label: Zone
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: zone

    - name: HTTP_METHOD
      label: HTTP Method
      type: enum
      enum:
        - CONNECT
        - DELETE
        - GET
        - HEAD
        - OPTIONS
        - PATCH
        - POST
        - PUT
        - TRACE
        - OTHER
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: http-method
          valueMapping:
            CONNECT:
              value: 1
            DELETE:
              value: 2
            GET:
              value: 3
            HEAD:
              value: 4
            OPTIONS:
              value: 5
            PATCH:
              value: 6
            POST:
              value: 7
            PUT:
              value: 8
            TRACE:
              value: 9
            OTHER:
              value: 0

    - name: HTTP_STATUS_CODE_GROUP
      label: Status Code Group
      type: enum
      enum:
        - 1xx
        - 2xx
        - 3xx
        - 4xx
        - 5xx
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: status
          valueMapping:
            1xx:
              range:
                gte: 100
                lte: 199
            2xx:
              range:
                gte: 200
                lte: 299
            3xx:
              range:
                gte: 300
                lte: 399
            4xx:
              range:
                gte: 400
                lte: 499

    - name: HTTP_STATUS
      label: Status Code
      type: integer
      range:
        min: 100
        max: 600
      operators:
        - EQ
        - LTE
        - GTE
      backend:
        elasticsearch:
          field: status

    - name: HTTP_PATH
      label: HTTP Path
      type: string
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: path-info

    - name: HTTP_PATH_MAPPING
      label: Path Mapping
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: mapped-path

    - name: HOST
      label: Host
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: host

    - name: GEO_IP_COUNTRY
      label: Country
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: geoip.country_iso_code

    - name: GEO_IP_REGION
      label: Region
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: geoip.region_name

    - name: GEO_IP_CITY
      label: City
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: geoip.city_name

    - name: GEO_IP_CONTINENT
      label: Continent
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: geoip.continent_name

    - name: CONSUMER_IP
      label: Consumer IP
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: remote-address

    - name: HTTP_USER_AGENT_OS_NAME
      label: User Agent OS
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: user_agent.os.name

    - name: HTTP_USER_AGENT_DEVICE
      label: User Agent Device
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: user_agent.device.name

    - name: MESSAGE_CONNECTOR_TYPE
      label: Connector Type
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: connector-type

    - name: MESSAGE_OPERATION_TYPE
      label: Operation
      type: enum
      enum:
        - Publish
        - Subscribe
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: operation
          valueMapping:
            Publish:
              value: publish
            Subscribe:
              value: subscribe

    - name: KAFKA_TOPIC
      label: Topic
      type: keyword
      operators:
        - EQ
        - IN
      backend:
        elasticsearch:
          field: topic

    - name: API_STATE
      label: API State
      type: enul
      enum:
        - STARTED
        - STOPPED
      operators:
        - EQ
        - IN
      backend:
        mongodb:
          collection: apis
          field: lifecycleState

    - name: API_LIFECYCLE_STATE
      label: API Lifecycle State
      type: enum
      enum:
        - PUBLISHED
        - UNPUBLISHED
        - DEPRECATED
      operators:
        - EQ
        - IN
      backend:
        mongodb:
          collection: apis
          field: apiLifecycleState
        valueMapping:
          PUBLISHED:
            value: PUBLISHED
          UNPUBLISHED:
            values:
              - UNPUBLISHED
              - CREATED
          DEPRECATED:
            value: DEPRECATED

    - name: API_VISIBILITY
      label: API Visibility
      type: enum
      enum:
        - PUBLIC
        - PRIVATE
      operators:
        - EQ
        - IN
      backend:
        mongodb:
          collection: apis
          field: visibility
        valueMapping:
          PUBLISHED:
            value: PUBLISHED
          PRIVATE:
            value: PRIVATE
